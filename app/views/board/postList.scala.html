@(title:String, project:Project, page:Page[Post], param:BoardApp.SearchCondition)

@header(label:String, key:String) = {
  <th>
    <a key="@key" href="@routes.BoardApp.posts(project.owner, project.name)">@label</a>
    @if(key == param.key){
      @if(param.order == "desc"){
        <i class="icon-chevron-down"></i>
      } else {
        <i class="icon-chevron-up"></i>
      }
    }
  </th>
}

@main(title, project) {
  <h1 class="page-title"><span class="gray">@project.owner/@project.name/</span>Board</h1>
  <div class="header-wrap">
    <div class="search-wrap board">
      <div class="inner">
        <form method="get">
          <input type="hidden" name="key" value="@param.key">
          <input type="hidden" name="order" value="@param.order">
          <input name="filter" class="text" type="text" placeholder="현재 게시글에서 검색" value="@param.filter"><button type="submit" class="btn-transparent search-btn">SEARCH</button>
        </form>
      </div>
    </div>
  </div>
  
  <div class="row-fluid">
    <div class="span12">
      <div class="pull-right">
        <form id="search-form" class="form-search form-inline" method="get">
          <input type="hidden" name="key" value="@param.key">
          <input type="hidden" name="order" value="@param.order">
          <input type="hidden" name="pageNum" value="@param.pageNum">
          <input type="text" name="filter" class="search-query">
          <button type="submit" class="btn"><i class="icon-search"></i></button>
          @roleCheck(session.get("userId"), project.id, models.enumeration.Resource.BOARD_POST, models.enumeration.Operation.WRITE){
          <a class="btn btn-primary" href="@routes.BoardApp.newPost(project.owner, project.name)" >@Messages("post.new")</a>
          }
        </form>
      </div>    
    </div>  
  </div>

  <div class="row-fluid">
    <div class="span12">
	    <ul class="nav nav-tabs" id="board_list">
	    	<li class="active"><a href="">전체</a></li>
	    </ul>
	    @if(page.getTotalRowCount == 0){
	    <div class="well">
	    	<p>등록된 글이 없습니다.</p>
	    </div>
	    }else{
	    <table class="table table-striped">
	    	<thead>
	    		<tr id="board_header">
	    		    @header("#", "id")
	    		    @header(Messages("post.new.title"), "title")
	    		    @header(Messages("post.author"), "authorName")
	    		    @header(Messages("post.age"), "date")
	    		</tr>
	    	</thead>
	    	<tbody>
	    		@for(post <- page.getList()){
	    		<tr>
	    			<td>@post.id</td>
	    			<td><a href="@routes.BoardApp.post(project.owner, project.name, post.id)">@post.title [@post.commentCount]</a></td>
	    			<td>@post.authorName</td>
	    			<td>@utils.TemplateHelper.agoString(post.ago())</td>
	    		</tr>
	    		}
	    	</tbody>
	    </table>
	    }
    </div>
  </div>

  <div class="row-fluid">  
      <a class="btn pull-right" href=""><i class="icon-ok"></i>@Messages("button.autoNotification")</a>
      @pagination(page, 5, "pagination")
  </div>
  <script type="text/javascript">
  nforge.require('board.list');
  </script>
}
